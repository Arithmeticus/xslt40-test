<?xml version="1.0" encoding="UTF-8"?>
<test-set xmlns:xs="http://www.w3.org/2001/XMLSchema"
          xmlns="http://www.w3.org/2012/10/xslt-test-catalog"
          name="normalize-unicode">
   
   <description>
      Test the fn:normalize-unicode() function introduced in XPath 2.0,
      together with the normalization-form option on serialization.
   </description>
   
   <environment name="unicode001">
      <source role="." file="unicode001.xml"/>
   </environment>

   <test-case name="normalize-unicode-001">
      <description>test normalize-unicode() default normalization form, trivial examples</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-001.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-001.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-002">
      <description>test normalize-unicode() explicit NFC normalization form, trivial examples</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-002.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-002.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-003">
      <description>test normalize-unicode() explicit NFD normalization form, trivial examples</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-003.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-003.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-004">
      <description>test normalize-unicode() explicit NFKC normalization form, trivial examples</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFKC"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-004.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-004.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-005">
      <description>test normalize-unicode() explicit NFKD normalization form, trivial examples</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-005.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-005.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-006">
      <description>test normalize-unicode() test all normalization forms on a string containing a mixture of different forms</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFD NFKC NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-006.xsl"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out>
   <nfc>197 197 197</nfc>
   <nfd>65 778 65 778 65 778</nfd>
   <nfkc>197 197 197</nfkc>
   <nfkd>65 778 65 778 65 778</nfkd>
</out>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="normalize-unicode-007">
      <description>test normalize-unicode() test all normalization forms on a string containing a mixture of different forms</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFD NFKC NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-007.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-007.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-008">
      <description>This test applies the normalize-unicode() function to the normalization conformance test published by the Unicode Consortium. If successful, no &lt;failure&gt; elements are output. For details of the test, see NormalizationTest.txt. The test has been modified to avoid using characters that are illegal in XML. e.g. 0055 030C e.g. 030C</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFD NFKC NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-008.xsl"/>
      </test>
      <result>
         <assert>empty(/out/node())</assert>
      </result>
   </test-case>

   <test-case name="normalize-unicode-009">
      <description>test normalize-unicode() test Latin Capital D with dot above 1E0B;1E0B;0064 0307;1E0B;0064 0307;</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-009.xsl"/>
      </test>
      <result>
         <assert-xml><![CDATA[<out>
   <nfc>7691</nfc>
   <nfc>7691</nfc>
   <nfd>100 775</nfd>
   <nfd>100 775</nfd>
</out>]]></assert-xml>
      </result>
   </test-case>

   <test-case name="normalize-unicode-010">
      <description>trivial test of normalized output (NFC)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-010.xsl"/>
      </test>
      <result>
         <all-of>
            <serialization-matches>üss=['"]üß['"].*üss=['"]üss['"]</serialization-matches>
            <serialization-matches>Straßenüberführung.*Straßenüberführung</serialization-matches>
         </all-of>
      </result>
   </test-case>

   <test-case name="normalize-unicode-011">
      <description>trivial test of normalized output (xml, NFD)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-011.xsl"/>
      </test>
      <result>
         <all-of>
            <serialization-matches><![CDATA[üss=['"]u&#(x308|776);ß['"].*üss=['"]u&#(x308|776);ss['"]]]></serialization-matches>
            <serialization-matches><![CDATA[Straßenu&#(x308|776);berfu&#(x308|776);hrung.*Straßenu&#(x308|776);berfu&#(x308|776);hrung]]></serialization-matches>
         </all-of>
      </result>
   </test-case>

   <test-case name="normalize-unicode-012">
      <description>trivial test of normalized output (xml, NFKC)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFKC"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-012.xsl"/>
      </test>
      <result>
         <all-of>
            <serialization-matches>üss=['"]üß['"].*üss=['"]üss['"]</serialization-matches>
            <serialization-matches>Straßenüberführung.*Straßenüberführung</serialization-matches>
         </all-of>
      </result>
   </test-case>

   <test-case name="normalize-unicode-013">
      <description>trivial test of normalized output (xml, NFKD)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-013.xsl"/>
      </test>
      <result>
         <all-of>
            <serialization-matches><![CDATA[üss=['"]u&#(x308|776);ß['"].*üss=['"]u&#(x308|776);ss['"]]]></serialization-matches>
            <serialization-matches><![CDATA[Straßenu&#(x308|776);berfu&#(x308|776);hrung.*Straßenu&#(x308|776);berfu&#(x308|776);hrung]]></serialization-matches>
         </all-of>
      </result>
   </test-case>

   <test-case name="normalize-unicode-014">
      <description>trivial test of normalized output (html, NFKD)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-014.xsl"/>
      </test>
      <result>
         <assert-serialization method="html" file="normalize-unicode-014.out" encoding="utf-8"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-015">
      <description>trivial test of normalized output (uncommited method, NFKD)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
         <additional_normalization_form value="support NFKD"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-015.xsl"/>
      </test>
      <result>
         <assert-serialization method="html" file="normalize-unicode-015.out" encoding="utf-8"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-016">
      <description>trivial test of normalized output (XHTML, result-document, NFC)</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-016.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-016.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-017">
      <description>trivial test of normalization-form="none"</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-017.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-017.out"/>
      </result>
   </test-case>

   <test-case name="normalize-unicode-018">
      <description>trivial test of normalization-form="none"</description>
      <created by="Michael Kay" on="2012-11-07"/>
      <environment ref="unicode001"/>
      <dependencies>
         <spec value="XSLT20+"/>
      </dependencies>
      <test>
         <stylesheet file="normalize-unicode-018.xsl"/>
      </test>
      <result>
         <assert-xml file="normalize-unicode-018.out"/>
      </result>
   </test-case>
</test-set>
